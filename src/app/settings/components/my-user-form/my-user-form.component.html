<form [formGroup]="group">
  <div [ngClass]="{ disabled: !isEditable }">
    <!-- Email -->
    <mat-form-field>
      <input
        matInput
        placeholder="Email"
        [readonly]="disableEmailInput"
        formControlName="email"
        data-qa="settings-user-email"
      />
      <mat-error>Invalid email address</mat-error>
    </mat-form-field>

    <!-- First Name -->
    <mat-form-field>
      <input
        matInput
        placeholder="First Name"
        formControlName="firstName"
        [ngClass]="{ editable: isEditable }"
        data-qa="settings-user-first-name"
      />
      <mat-error>This field is required</mat-error>
    </mat-form-field>

    <!-- Last Name -->
    <mat-form-field>
      <input
        matInput
        placeholder="Last Name"
        formControlName="lastName"
        [ngClass]="{ editable: isEditable }"
        data-qa="settings-user-last-name"
      />
      <mat-error>This field is required</mat-error>
    </mat-form-field>

    <!-- Phone Number -->
    <mat-form-field>
      <input
        matInput
        placeholder="Phone Number"
        formControlName="phone"
        [ngClass]="{ editable: isEditable }"
        data-qa="settings-user-phone-number"
      />
      <mat-error>Invalid phone number</mat-error>
    </mat-form-field>

    <mat-form-field *ngIf="myUserPage">
      <mat-label>Summary Email Frequency</mat-label>
      <mat-select 
        formControlName="emailFrequency"
        [ngClass]="{ editable: isEditable }" 
        data-qa="settings-user-emailFrequency"
      >
        <mat-option *ngFor="let frequency of emailFrequency" [value]="frequency">
          {{ frequency }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field *ngIf="myUserPage && [Frequency.Weekly, Frequency.Monthly].includes(formValue.emailFrequency)">
      <mat-label>Day of the week</mat-label>
      <mat-select 
        formControlName="days"
        [ngClass]="{ editable: isEditable }"
        data-qa="settings-user-dayOfTheWeek"
      >
        <mat-option *ngFor="let day of days; let i = index" [value]="day">
          <span *ngIf="formValue.emailFrequency === Frequency.Weekly">Every</span>
          <span *ngIf="formValue.emailFrequency === Frequency.Monthly">First</span>
          {{ day }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div *ngIf="myUserPage; else elseBlock" style="margin-bottom: 20px;">
      <div>
        <span class="label">My Teams</span>
        <ul *ngFor="let team of userTeams">
          <li>{{ team.name }}</li>
        </ul>
      </div>

      <div>
        <span class="label">My Roles</span>
        <ul *ngFor="let role of userRole">
          <li>{{ role.name }}</li>
        </ul>
      </div>
    </div>

    <ng-template #elseBlock>
      <!-- My Teams -->
      <mat-form-field>
        <mat-select placeholder="My Teams" multiple formControlName="team" [compareWith]="compareFn"
          [ngClass]="{ editable: isEditable }" data-qa="settings-user-teams">
          <mat-option *ngFor="let team of teams" [value]="team">
            {{ team.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    
      <!-- My Roles -->
      <mat-form-field>
        <mat-select placeholder="My Roles" multiple formControlName="roles" [compareWith]="compareFn"
          [ngClass]="{ editable: isEditable }" data-qa="settings-user-roles">
          <mat-option *ngFor="let role of roles" [value]="role">
            {{ role.name }}
          </mat-option>
        </mat-select>
        <mat-error>Role is required</mat-error>
      </mat-form-field>
    </ng-template>
  </div>

  <div class="form-actions" *ngIf="!modalMode">
    <ng-container *ngIf="canEdit">
      <button
        mat-raised-button
        color="primary"
        *ngIf="!isEditable; else elseBlock"
        (click)="onEdit()"
        data-qa="settings-user-edit"
      >
        Edit
      </button>
      <button
        mat-raised-button
        class="status-btn"
        *ngIf="!myUserPage && !isEditable"
        (click)="onDelete()"
        data-qa="settings-user-activate-or-deactivate"
      >
        {{ userStatus }}
      </button>
    </ng-container>
    <button
      mat-button
      color="primary"
      *ngIf="myUserPage && !isEditable"
      (click)="onChangePassword()"
      data-qa="settings-user-change-password"
    >
      Change Password
    </button>
    <ng-template #elseBlock>
      <button mat-raised-button color="primary" (click)="onSave()" data-qa="settings-user-save">Save</button>
      <button mat-raised-button (click)="onCancel()" data-qa="settings-user-cancel">Cancel</button>
    </ng-template>
  </div>
</form>
