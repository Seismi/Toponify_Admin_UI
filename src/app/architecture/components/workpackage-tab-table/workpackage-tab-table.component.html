<div class="wrapper">
  <div class="search-container" *ngIf="dataSource.data.length">
    <input placeholder="Search" data-qa="topology-work-packages-quick-search" (keyup)="onSearch($event.target.value)">
  </div>
  <table mat-table [dataSource]="dataSource">
    <ng-container matColumnDef="workpackage">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <div class="row" [ngClass]="{ selected: element.selected }">
          <span class="title">{{ element.name }}</span>
          <mat-icon
            matTooltip="Open work package details"
            [routerLink]="['/work-packages', element.id]"
            queryParamsHandling="preserve"
          >
            open_in_new
          </mat-icon>
            <div class="actions">
              <mat-button-toggle-group>
                <mat-button-toggle
                  data-qa="topology-work-packages-off"
                  (change)="switchOff(element)"
                  checked=true
                >
                  Off
                </mat-button-toggle>
                <mat-button-toggle
                  data-qa="topology-work-packages-select-work-package"
                  [ngClass]="{ disabled: !canSelect(element) }"
                  [checked]="element.selected"
                  (click)="onSelect(element.id, !element.selected, $event, element)"
                >
                  Display
                </mat-button-toggle>
                <mat-button-toggle
                  data-qa="topology-work-packages-edit"
                  [checked]="element.edit"
                  [ngClass]="{ disabled: !canEdit(element) }"
                  (click)="onSetWorkpackageEditMode(element)"
                  matTooltip="Edit content of work package"
                >
                  Edit
                </mat-button-toggle>
              </mat-button-toggle-group>

              <smi-color-picker
                style="margin-right: 5px;"
                matTooltip="Colour of the objects modified by this work package"
                [workpackageColour]="element.displayColour"
                (selectColour)="onSelectColour($event, element.id)"
                [isEditable]="true"
              >
              </smi-color-picker>
              <label>Colour</label>
            </div>
          </div>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns" style="display: none;"></tr>
    <tr mat-row *matRowDef="let row; let i = index; columns: displayedColumns"></tr>
  </table>
  <br>
  <p class="message" *ngIf="!dataSource.data.length">No active work packages. To create a new work package, <a routerLink="/work-packages">click here</a></p>
</div>
<smi-spinner *ngIf="isLoading"></smi-spinner>