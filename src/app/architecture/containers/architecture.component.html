<app-base-header>
  <app-toolbar-column [fillFreeSpace]="true">
    <app-search></app-search>
  </app-toolbar-column>
  <app-toolbar-column>
    <app-zoom-actions
      [attributesView]="attributesView"
      (zoomIn)="onZoomIn($event)"
      (zoomOut)="onZoomOut($event)"
    ></app-zoom-actions>
    <app-layout-actions *ngIf="!attributesView"
      (showGrid)="onShowGrid($event)"
      [showOrHideGrid]="showOrHideGrid"
      (zoomMap)="onZoomMap($event)"
  ></app-layout-actions>
  </app-toolbar-column>
  <app-toolbar-column>
    <smi-quicklinks-actions
      [gojsView]="true" 
      [allowEditLayouts]="allowEditLayouts"
      [allowEditWorkPackages]="allowEditWorkPackages"
      [workpackages]="workpackage$ | async"
      [scopes]="scopes$ | async"
      [layouts]="scopeDetails$ | async"
      (editWorkPackage)="allowEditWorkPackage($event)"
      (editLayout)="allowEditLayout($event)"
      (selectWorkPackage)="onSelectWorkPackage($event)"
      (selectScope)="onSelectScope($event)"
      (selectLayout)="onSelectLayout($event)">
    </smi-quicklinks-actions>
  </app-toolbar-column>
</app-base-header>
<app-model-container [topPadding]="64">
  <app-model-sidebar [minWidth]="430" [maxWidth]="1000">
    <p>
      <smi-left-panel
        [data]="workpackage$ | async"
        [workPackageIsEditable]="workPackageIsEditable"
        (displayOptionsChangedEvent)="displayOptionsChanged($event)"
        (selectWorkPackage)="onSelectWorkPackage($event)"
        (selectColor)="selectColorForWorkPackage($event)">
      </smi-left-panel>
    </p>
  </app-model-sidebar>

  <app-model-content>
    <div style="padding: 5px">
      <app-architecture-diagram
        [mapView]="mapView"
        [showGrid]="showGrid"
        [allowMove]="allowMove"
        *ngIf="!showTable"
        [nodes]="nodes | layer:{byId: true}"
        [links]="links | layer:{byId: false}"
        [workpackageDetail]="workpackageDetail"
        [selectedWorkPackages]= "selectedWorkPackages$ | async"
        [viewLevel]="viewLevel$ | async"
        (nodeSelected)="partSelected($event)"
        (modelChanged)="modelChanged($event)"
        (nodeDeleteRequested)="handleNodeDeleteRequested($event)"
        (linkDeleteRequested)="handleLinkDeleteRequested($event)"
        (updateNodeLocation)="handleUpdateNodeLocation($event)">
      </app-architecture-diagram>
    </div>
  </app-model-content>
  <smi-right-sidebar *ngIf="!showOrHideRightPane" (rightTab)="openRightTab($event)">
  </smi-right-sidebar>
  <app-model-sidebar [isLast]="true" [maxWidth]="600" *ngIf="showOrHideRightPane">
    <p>
      <smi-right-panel
        [selectedRightTab]="selectedRightTab"
        [group]="objectDetailsForm"
        [clickedOnLink]="clickedOnLink"
        [nodeSelected]="objectSelected"
        [isEditable]="isEditable"
        (editDetails)="onEditDetails($event)"
        (saveAttribute)="onSaveObjectDetails($event)"
        (deleteAttribute)="onDeleteAttribute($event)"
        [data]="nodeDetail$ | async"
        (cancel)="onCancelEdit($event)"
        [workPackageIsEditable]="workPackageIsEditable"
        (hideRightPane)="onHideRightPane()"
      >
      </smi-right-panel>
    </p>
  </app-model-sidebar>
</app-model-container>
