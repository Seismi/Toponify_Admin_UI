<div class="container">
<button mat-stroked-button color="primary" (click)="onAdd()">New Version</button>
<br><br>
<div class="mat-elevation-z8">
  <table mat-table
    [dataSource]="dataSource"
    multiTemplateDataRows
    matSort>

  <!-- Preview Image Column -->
   <ng-container matColumnDef="previewImage">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <!--<img [src]="'data:image/jpg;base64,'+ element.previewImage"/>-->
        <img src="./assets/images/Seismi-logo-Blue.png" />
      </td>
    </ng-container>

   <!-- Name Column -->
   <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
      <td mat-cell *matCellDef="let element">
        <div class="row" (click)="expandedElement = expandedElement === element ? null : element">
          {{element.name}}
          <small class="badge badge-success" *ngIf="element.status === 'archived'">archive</small>
        </div>
      </td>
    </ng-container>

    <!-- LastUpdatedOn Column -->
    <ng-container matColumnDef="lastUpdatedOn">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Last Updated On </th>
      <td mat-cell *matCellDef="let element">
        <div class="row" (click)="expandedElement = expandedElement === element ? null : element">
          {{element.lastUpdatedOn | date}}
        </div>
      </td>
    </ng-container>

     <!-- Star Column -->
     <ng-container matColumnDef="star" stickyEnd>
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <mat-icon [matMenuTriggerFor]="menu">more_vert</mat-icon>
          <br>
          <mat-icon (click)="expandedElement = expandedElement === element ? null : element">keyboard_arrow_down</mat-icon>
          <mat-menu #menu="matMenu" [xPosition]="'before'">
              <button mat-menu-item class="options-menu" [matMenuTriggerFor]="views"><mat-icon>open_with</mat-icon>Views</button>
                <mat-menu #views="matMenu">
                    <button mat-menu-item class="options-menu" (click)="onOpen(element.id, viewLevels.system)">Systems</button>
                    <button mat-menu-item class="options-menu" (click)="onOpen(element.id, viewLevels.model)">Models</button>
                    <button mat-menu-item class="options-menu" (click)="onOpen(element.id, viewLevels.dimension)">Dimensions</button>
                    <button mat-menu-item class="options-menu" (click)="onOpen(element.id, viewLevels.element)">Elements</button>
                    <button mat-menu-item class="options-menu" (click)="onOpen(element.id, viewLevels.attribute)">Attributes</button>
                </mat-menu>
              <button mat-menu-item class="options-menu"><mat-icon>track_changes</mat-icon>Audit</button>
              <button mat-menu-item class="options-menu"><mat-icon>arrow_downward</mat-icon>Export to PDF</button>
              <button mat-menu-item class="options-menu" (click)="onEdit(element.id)"><mat-icon>edit</mat-icon>Edit</button>
              <button mat-menu-item class="options-menu" (click)="onCopy(element.id)"><mat-icon>file_copy</mat-icon>Copy</button>
              <button mat-menu-item class="options-menu" *ngIf="element.status === 'active'" (click)="onArchive(element.id)"><mat-icon>archive</mat-icon>Archive</button>
              <button mat-menu-item class="options-menu" *ngIf="element.status === 'archived'" (click)="onUnarchive(element.id)"><mat-icon>archive</mat-icon>Unarchive</button>
              <button mat-menu-item class="options-menu" *ngIf="element.status === 'archived'" (click)="onDelete(element.id)"><mat-icon>delete</mat-icon>Delete</button>
          </mat-menu>
        </td>
      </ng-container>

    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
    <ng-container matColumnDef="expandedDetail">
      <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
        <div class="element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
          <div class="element-description" *ngIf="element.description else noDescription">
            <i>{{element.description}}</i>
          </div>
          <!-- Show this template if there isn't description -->
          <ng-template #noDescription>
            <div class="element-description">
              <i>No description...</i>
            </div>
          </ng-template>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let element; columns: displayedColumns;" class="element-row"
      [class.expanded-row]="expandedElement === element"
      (dblclick)="onOpen(element.id, viewLevels.system) " >
    </tr>
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
    <td mat-cell *matCellDef="let element"></td>
  </table>

    <div *ngIf="!dataSource.filteredData.length">
      <p class="noVersionFound">No versions found</p>
    </div>

    <mat-checkbox [(ngModel)]="checked" (change)="setStatus($event)" [disabled]="!dataSource.filteredData.length">Show Archived Versions</mat-checkbox>
    <mat-paginator [pageSizeOptions]="[5, 10, 15]"></mat-paginator>
</div>
</div>
